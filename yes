-- Define the relevant folders and names
local effectsFolder = workspace:WaitForChild("Effects") -- Folder where WindArrow gets added
local npcFolder = workspace:WaitForChild("BadNPCs") -- Folder containing NPCs
local projectileName = "WindArrow" -- Name of the projectile
local targetName = "Golem" -- Name of the NPCs to target

-- Function to find the humanoid of a Golem
local function getHumanoid(npc)
    return npc:FindFirstChildOfClass("Humanoid")
end

-- Function to teleport the projectile to a Golem
local function teleportToNPC(projectile, npc)
    if projectile and projectile.Parent == effectsFolder and npc:IsA("Model") and npc.Name == targetName then
        local targetPart = npc:FindFirstChild("HumanoidRootPart") or npc:FindFirstChild("Head")
        if targetPart then
            projectile.CFrame = targetPart.CFrame -- Teleport WindArrow to the Golem
        end
    end
end

-- Function to handle the WindArrow behavior
local function onWindArrowAdded(projectile)
    if projectile.Name == projectileName and projectile:IsA("UnionOperation") then
        print("WindArrow detected, starting targeting system...")

        -- Loop through Golems and teleport the WindArrow
        while projectile.Parent == effectsFolder do
            for _, npc in ipairs(npcFolder:GetChildren()) do
                if npc:IsA("Model") and npc.Name == targetName then
                    local humanoid = getHumanoid(npc)
                    if humanoid and humanoid.Health > 0 then
                        -- Teleport the projectile to this Golem
                        teleportToNPC(projectile, npc)
                        
                        -- Wait for the Golem to die or a short delay before retargeting
                        while humanoid.Health > 0 and projectile.Parent == effectsFolder do
                            task.wait(0.1)
                        end
                    end
                end
            end
            task.wait(0.1) -- Small delay to avoid overloading
        end
    end
end

-- Monitor the Effects folder for the projectile
effectsFolder.ChildAdded:Connect(function(child)
    if child.Name == projectileName then
        task.wait(0.1) -- Optional delay to ensure it initializes
        onWindArrowAdded(child)
    end
end)

-- Check if the projectile already exists in the folder
local existingProjectile = effectsFolder:FindFirstChild(projectileName)
if existingProjectile then
    task.wait(0.1) -- Optional delay to ensure it initializes
    onWindArrowAdded(existingProjectile)
end
